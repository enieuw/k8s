wget https://dl.k8s.io/v1.13.3/kubernetes-server-linux-amd64.tar.gz
tar -xzvf kubernetes-server-linux-amd64.tar.gz
sudo mkdir -p /opt/bin
sudo cp kubernetes/server/bin/hyperkube /opt/bin
sudo cp kubernetes/server/bin/kubectl /opt/bin
sudo cp kubernetes/server/bin/kube-proxy /opt/bin

kubectl config set-cluster myfirstcluster --server=http://172.17.8.101:8080 --insecure-skip-tls-verify=true
kubectl config set-context local --cluster=myfirstcluster
kubectl config use-context local
sudo mkdir -p /var/lib/kubelet
sudo cp ~/.kube/config /var/lib/kubelet/kubeconfig

wget https://github.com/containernetworking/plugins/releases/download/v0.7.4/cni-plugins-amd64-v0.7.4.tgz
tar -xzvf cni-plugins-amd64-v0.7.4.tgz
sudo mkdir -p /opt/cni/bin
sudo cp loopback /opt/cni/bin/
sudo cp portmap /opt/cni/bin/

sudo hyperkube kubelet --pod-manifest-path=/etc/kubernetes/manifests/ --kubeconfig=/var/lib/kubelet/kubeconfig --hostname-override=172.17.8.102 --allow-privileged  --network-plugin=cni --cluster-dns=10.0.0.86 &
sudo kube-proxy --master=http://172.17.8.101:8080 --hostname-override=172.17.8.102 --masquerade-all &
